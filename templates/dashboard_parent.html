{% extends "base.html" %}
{% block title %}Parent Dashboard{% endblock %}
{% block content %}
<div class="container mt-5" style="max-width: 650px; margin: 0 auto; text-align: center;">
  <div class="card p-4 shadow-sm">
    <h2 class="mb-3">ยินดีต้อนรับ {{ parent.first_name }}</h2>

    {% if family_code %}
      <p>รหัสครอบครัวของคุณ:</p>
      <div id="famcode" style="font-size: 1.5rem; font-weight: 700; letter-spacing: 2px; margin: 10px 0;">
        {{ family_code }}
      </div>
      <button type="button" onclick="navigator.clipboard.writeText(document.getElementById('famcode').innerText)" class="btn btn-secondary btn-sm">คัดลอก</button>
      <p class="text-muted mt-2">ให้ Kid ใช้รหัสนี้เพื่อเข้าร่วมครอบครัว</p>
    {% else %}
      <form method="post" action="/parent/{{ pid }}/family/create" class="mt-3">
        <div class="form-group mb-2">
          <label for="family_name">ชื่อครอบครัว</label>
          <input name="family_name" id="family_name" class="form-control" placeholder="ตั้งชื่อบ้านของคุณ" required>
        </div>
        <button class="btn btn-primary w-100 mt-2" type="submit">สร้างครอบครัว</button>
      </form>
    {% endif %}

    <hr class="my-4">
    <h4>สร้างงานให้ลูก</h4>
    <form method="post" action="/parent/{{ pid }}/task/create" style="display: grid; gap: 10px; margin-top: 10px;">
      <label for="kid_id" class="fw-bold">เลือก Kid</label>
      <select name="kid_id" id="kid_id" class="form-select" required>
        <option value="">-- เลือก Kid --</option>
        {% for kid in kids %}
          <option value="{{ kid.id }}">{{ kid.first_name }} (ID: {{ kid.id }})</option>
        {% endfor %}
      </select>
      <input name="title" placeholder="ชื่อภารกิจ" class="form-control" required>
      <input name="points" type="number" placeholder="แต้มที่ได้" class="form-control" required>
      <textarea name="description" class="form-control" placeholder="รายละเอียดเพิ่มเติม (ถ้ามี)"></textarea>
      <button class="btn btn-success mt-2" type="submit">เพิ่มภารกิจ</button>
    </form>

    <hr class="my-4">
    <h4>เพิ่มของรางวัล</h4>
    <form method="post" action="/parent/{{ pid }}/reward/add" enctype="multipart/form-data" style="display: grid; gap: 10px; margin-top: 10px;">
      <input name="name" placeholder="ชื่อของรางวัล" class="form-control" required>
      <input name="cost" type="number" placeholder="แต้มที่ใช้แลก" class="form-control" required>
      <textarea name="description" class="form-control" placeholder="รายละเอียดเพิ่มเติม (ถ้ามี)"></textarea>
      <input type="file" name="image" class="form-control">
      <button class="btn btn-warning mt-2" type="submit">เพิ่มรางวัล</button>
    </form>

    <hr class="my-4">
    <a class="btn btn-outline-danger w-100" href="/login">ออกจากระบบ</a>
  </div>
</div>
{% endblock %}