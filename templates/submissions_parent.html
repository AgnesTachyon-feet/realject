{% extends "base.html" %}
{% block title %}ตรวจงานของเด็ก{% endblock %}

{% block content %}
<div class="card" style="max-width:1000px;margin:auto;">
  <div style="display:flex;justify-content:space-between;align-items:center;gap:12px;">
    <h2 style="margin:0;">งานที่รอตรวจ</h2>
    <a class="btn" href="{{ request.url_for('dashboard_parent', pid=pid) }}">← กลับแดชบอร์ด</a>
  </div>

  {% if items and items|length > 0 %}
    <div style="display:grid;gap:12px;margin-top:14px;">
      {% for it in items %}
        <div class="pill" style="text-align:left;">
          <div style="display:flex;justify-content:space-between;align-items:flex-start;gap:12px;flex-wrap:wrap;">
            <div style="min-width:260px;">
              <div style="font-weight:800">{{ it.task_title }}</div>
              <div style="color:#666;font-size:0.9rem">
                จาก: <b>{{ it.kid_name }}</b> · คะแนนงาน: <b>{{ it.task_points }}</b> · ส่งเมื่อ {{ it.submitted_at|th_datetime }}
              </div>
              {% if it.message %}
                <div style="margin-top:8px;">ข้อความจากเด็ก: <div class="pill" style="background:#fff;border:1px dashed #ccc">{{ it.message }}</div></div>
              {% endif %}
              {% if it.evidence_path %}
                <div style="margin-top:8px;">
                  หลักฐาน:
                  {% if it.evidence_path.endswith('.png') or it.evidence_path.endswith('.jpg') or it.evidence_path.endswith('.jpeg') or it.evidence_path.endswith('.gif') %}
                    <div style="margin-top:6px;">
                      <img src="/{{ it.evidence_path }}" alt="evidence" style="max-width:360px;border-radius:12px;border:1px solid #eee;">
                    </div>
                  {% else %}
                    <div style="margin-top:6px;">
                      <a class="btn" href="/{{ it.evidence_path }}" target="_blank">เปิดไฟล์แนบ</a>
                    </div>
                  {% endif %}
                </div>
              {% endif %}
            </div>

            <form method="post" action="{{ request.url_for('parent_decide_submission', sid=it.submission_id) }}" style="display:flex;gap:8px;margin:0;">
              <input type="hidden" name="pid" value="{{ pid }}">
              <button class="btn" name="approve" value="yes" type="submit">submit</button>
              <button class="btn" name="approve" value="no"  type="submit" style="background:#cc2727;border:1px solid #bda2a2;">eject</button>
            </form>
          </div>
        </div>
      {% endfor %}
    </div>
  {% else %}
    <div class="empty" style="margin-top:16px;">ยังไม่มีงานที่รอตรวจ</div>
  {% endif %}
</div>
{% endblock %}
